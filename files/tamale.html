<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
	<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>LuaDoc</h1>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h1>Modules</h1>
<ul>

	<li>
		<a href="../modules/tamale.html">tamale</a>
	</li>

</ul>



<!-- File list -->

<h1>Files</h1>
<ul>

	<li><strong>tamale.lua</strong></li>
	
</ul>






</div> <!-- id="navigation" -->

<div id="content">

<h1>File <code>tamale.lua</code></h1>


<p>TAble-MAtching Lua Extension.</p>






<h2>Functions</h2>
<table class="function_list">

	<tr>
	<td class="name" nowrap><a href="#P">P</a>&nbsp;(str)</td>
	<td class="summary">Treat a value as a pattern, rather than a string literal.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#match_fail">match_fail</a>&nbsp;(val)</td>
	<td class="summary">Default hook for match failure.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#matcher">matcher</a>&nbsp;(spec)</td>
	<td class="summary">Return a matcher function for a given specification.</td>
	</tr>

	<tr>
	<td class="name" nowrap><a href="#var">var</a>&nbsp;(name)</td>
	<td class="summary">Mark a string in a match pattern as a variable key.</td>
	</tr>

</table>






<br/>
<br/>




<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="P"></a><strong>P</strong>&nbsp;(str)</dt>
<dd>
Treat a value as a pattern, rather than a string literal. Returns a function closure that calls :match against the input (for matching via pattern strings, LPEG patterns, etc.), rather than comparing via ==. This would probably be locally aliased, and used like { P"num %d+", handler }.


<h3>Parameters</h3>
<ul>
	
	<li>
	  str: 
	</li>
	
</ul>








</dd>




<dt><a name="match_fail"></a><strong>match_fail</strong>&nbsp;(val)</dt>
<dd>
Default hook for match failure.


<h3>Parameters</h3>
<ul>
	
	<li>
	  val: The unmatched value.
	</li>
	
</ul>








</dd>




<dt><a name="matcher"></a><strong>matcher</strong>&nbsp;(spec)</dt>
<dd>
Return a matcher function for a given specification. When the function is called on one or more values, its first argument is tested in order against every row that could possibly match it, selecting the relevant result (if any) or returning the values (false, "Match failed", val). If the result is a function, it is called with an environment table containing any captures and any subsequent arguments passed to the matcher function (in env.args).


<h3>Parameters</h3>
<ul>
	
	<li>
	  spec: A list of rows, where each row is of the form { pattern, result, [when=capture_test_fun(cs)] }. Each table pattern is indexed by pattern[1].
	</li>
	
</ul>




<h3>Usage</h3>
<ul>
	
	<li>spec.ids: An optional list of table values that should be compared by identity, not structure. If any empty tables are being used as a sentinel value (e.g. "MAGIC_ID = {}"), list them here.
	
	<li>spec.debug: Turn on debugging traces for the matcher.
	
</ul>





</dd>




<dt><a name="var"></a><strong>var</strong>&nbsp;(name)</dt>
<dd>
Mark a string in a match pattern as a variable key. (You probably want to alias this locally to something short.) Any variables beginning with _ are ignored.


<h3>Parameters</h3>
<ul>
	
	<li>
	  name: 
	</li>
	
</ul>




<h3>Usage</h3>
<ul>
	
	<li>{ "extract", {var"_", var"_", var"third", var"_" } }
	
	<li>A variable named "..." captures subsequent array-portion values.
	
</ul>





</dd>


</dl>







</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
